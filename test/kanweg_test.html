<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">

    <title>kgui-multi-digits test</title>

    <script src="../../webcomponentsjs/webcomponents-lite.js"></script>
    <script src="../../web-component-tester/browser.js"></script>

    <link rel="import" href="../kgui-multi-digits.html">
  </head>
  <body>
    <test-fixture id="basic">
      <template>
        <kgui-multi-digits format="##,##" number="1,5"></kgui-multi-digits>
      </template>
    </test-fixture>

    <script>
      /* global
          suite, setup, fixture, test, assert
       */

      suite('kgui-multi-digits', function() {
        var decimalSeparator = (1.1).toLocaleString().replace(/1/g, '');
        var element;
        
        /**
         * To fire a CLICK event on those ADD, SUBTRACT buttons.
         * @param {Element} el element object to dispatch the EVENT `type` on.
         * @param {String} eType stands for EventType
         */
        function eventFire(el, eType) {
          if (el.fireEvent) {
            el.fireEvent('on' + eType);
          } else {
            var evObj = document.createEvent('Events');
            evObj.initEvent(eType, true, false);
            el.dispatchEvent(evObj);
          }
        }
        // Will be executed at the beginning of every test().
        setup(function() {
          element = fixture('basic');
        });

        // -----------------------------------------------------------------------------------
        // Elementary
        // -----------------------------------------------------------------------------------

        test('ss', function() {
          element.setAttribute('format', '##,##');
          element.setAttribute('number', '1,5');

          eventFire(element.$$('#digit0').$.btnUp, 'click'); // Make 1,51
          eventFire(element.$$('#digit0').$.btnUp, 'click'); // Make 1,52
          eventFire(element.$$('#digit0').$.btnUp, 'click'); // Make 1,53
          eventFire(element.$$('#digit0').$.btnUp, 'click'); // Make 1,54
          eventFire(element.$$('#digit0').$.btnUp, 'click'); // Make 1,55
          eventFire(element.$$('#digit0').$.btnUp, 'click'); // Make 1,56
          eventFire(element.$$('#digit0').$.btnUp, 'click'); // Make 1,57
          eventFire(element.$$('#digit0').$.btnUp, 'click'); // Make 1,58
          eventFire(element.$$('#digit0').$.btnUp, 'click'); // Make 1,59
          eventFire(element.$$('#digit0').$.btnUp, 'click'); // Make 1,60
          assert.equal(element._number, 1.6);
          assert.equal(element.number, '1,6');
          eventFire(element.$$('#digit0').$.btnUp, 'click'); // Make 1,61
          assert.equal(element._number, 1.61);
          assert.equal(element.number, '1,61');

          eventFire(element.$$('#digit0').$.btnDown, 'click'); // Make 1,60
          eventFire(element.$$('#digit0').$.btnDown, 'click'); // Make 1,59
          assert.equal(element._number, 1.59);
          assert.equal(element.number, '1,59');

          element.setAttribute('number', '0,99');
          assert.equal(element._number, 0.99);
          assert.equal(element.number, '0,99');
          eventFire(element.$$('#digit0').$.btnUp, 'click'); // Make 1,00
          assert.equal(element._number, 1);
          assert.equal(element.number, '1');
        });
      });

    </script>
  </body>
</html>
